---
layout: post
title:  "【OS】计算机网络 总结"
crawlertitle: "计算机网络"
summary: "Computer Networking"
date:   2019-09-01 10:00:00 +0800
categories: posts
tags: 'CS'
author: xusc
bg: "CS.jpg"
---

`计算机网络`是指将地理位置不同的具有独立功能的多台计算机及其外部设备，通过通信线路连接起来，在网络操作系统、网络管理软件及网络通信协议的管理和协调下，实现资源共享和信息传递的计算机系统。

### 概论
通信方式
- 客户-服务器（C/S）
- 对等（P2P）

网络性能指标
- 速率：又称比特率。指的是单位时间传送的比特数，其单位是`bit/s`。一个bit就是一个二进制数字中的一个1或0。 
- 带宽：在计算机网络中，带宽用来表示通信线路的数据传输能力，因此网络带宽指的是在单位时间内从网络中的某一点到另一点所能通过的最高速率。
- 时延 ：时延指的是数据从网络的一端传送到另一端所需的时间。
  - 发送时延：主机或者路由器发送数据帧说需要的时间。`发送时延 = 数据帧长度(b) / 发送速率(b/s)`
  - 传播时延：电磁波在信道中传播一定距离需要话费的时间。`传播时延 = 信道长度(m) / 电磁波在信道上的传播速率(m/s)`
  - 处理时延：主机或者路由器在接受到分组时候要话费一定的时间进行处理。
  - 排队时延：分组在进入路由器后要先在输入队列中等待处理。
- 时延带宽积：表示一个链路可以容纳的最多比特。`时延带宽积 = 传播时延 * 带宽`

数据交换方式
- 电路交换：整个报文的比特流连续的从源点直达终点，好像在一个管道中传送。
- 报文交换：整个报文先传输到相邻的结点，全部存储下来后查找转发表，转发到下一个结点。
- 分组交换：单个分组（报文的一部分）传送到相邻结点，传送到相邻结点，存储下来后查找转发表，转发到下一个结点。

![](/assets/images/2019/swap.png)

计算机网络体系结构
- OSI
- TCP/IP

### 物理层
通信方式：
- 单工通信：单向传输
- 半双工通信：双向交替传输
- 全双工通信：双向同时传输

来自信源的信号常称为基带信号，为了能传输基带信号中的低频分量或直流分量必须对基带信号进行调制（modulation）。调制可分为两大类：
- 基带调制：又称编码，把数字信号转换为另一种形式的数字信号
- 带通调制：把数字信号转换为模拟信号

信道
- 信道分类
  - 广播信道
  - 点对点信道
- 信道复用技术
  - 频分复用 FDM
  - 时分复用 TDM
  - 波分复用 WDM
  - 码分复用 CDM

物理层的接口的特性
- 机械特性
- 电气特性
- 功能特性
- 规程特性

常见的物理层设备
- 中继器：又称转发器，主要功能是将信号整形并放大再转发出去。
- 集线器：实质上是一个多端口的中继器。

### 数据链路层
基本概念
- 封装成帧：将网络层传下来的分组添加首部和尾部，用于标记帧的开始和结束。
- 透明传输
- 差错检测：目前数据链路层广泛使用了循环冗余检验（CRC）来检查比特差错。


CSMA/CD 表示载波监听多点接入 / 碰撞检测。
- 多点接入 ：说明这是总线型网络，许多主机以多点的方式连接到总线上。
- 载波监听 ：每个主机都必须不停地监听信道。在发送前，如果监听到信道正在使用，就必须等待。
- 碰撞检测 ：在发送中，如果监听到信道已有其它主机正在发送数据，就表示发生了碰撞。虽然每个主机在发送数据之前都已经监听到信道为空闲，但是由于电磁波的传播时延的存在，还是有可能会发生碰撞。

PPP 协议是用户计算机和 ISP 进行通信时所使用的数据链路层协议。

局域网：是一种典型的广播信道，主要特点是网络为一个单位所拥有，且地理范围和站点数目均有限。
- 以太网是一种星型拓扑结构局域网。
- 虚拟局域网可以建立与物理位置无关的逻辑组，只有在同一个虚拟局域网中的成员才会收到链路层广播信息。

交换机具有自学习能力，学习的是交换表的内容，交换表中存储着 MAC 地址到接口的映射。


### 网络层
IP 协议，可以把异构的物理网络连接起来，使得在网络层看起来好像是一个统一的网络。与 IP 协议配套使用的三个协议：
- 地址解析协议 ARP（Address Resolution Protocol）：实现由 IP 地址得到 MAC 地址。
- 网际控制报文协议 ICMP（Internet Control Message Protocol）：为了更有效地转发 IP 数据报和提高交付成功的机会。它封装在 IP 数据报中。重要应用：
  - ping
  - traceroute
- 网际组管理协议 IGMP（Internet Group Management Protocol）

IP 地址
![](/assets/images/2019/IP地址.png)

路由选择协议：
- 自治系统内部的路由选择
  - 内部网关协议 RIP：基于距离向量的路由选择协议。
  - 内部网关协议 OSPF：为了克服 RIP 的缺点而开发出来的。
- 自治系统间的路由选择：BGP

网络地址转换 NAT：专用网内部的主机使用本地 IP 地址又想和互联网上的主机通信时，可以使用 NAT 来将本地 IP 转换为全球 IP。

路由器
- 功能：路由选择和分组转发。
- 分组转发结构由三个部分组成：交换结构、一组输入端口和一组输出端口。
- 转发流程：
  1. 从数据报的首部提取目的主机的 IP 地址 D，得到目的网络地址 N。
  2. 若 N 就是与此路由器直接相连的某个网络地址，则进行直接交付；
  3. 若路由表中有目的地址为 D 的特定主机路由，则把数据报传送给表中所指明的下一跳路由器；
  4. 若路由表中有到达网络 N 的路由，则把数据报传送给路由表中所指明的下一跳路由器；
  5. 若路由表中有一个默认路由，则把数据报传送给路由表中所指明的默认路由器；
  6. 报告转发分组出错。


### 传输层

比较|UDP|TCP
:-:|:-:|:-:
名称|User Datagram Protocol<br/>用户数据报协议|Transmission Control Protocol<br/>传输控制协议
有无连接|无连接|面向连接
是否可靠|尽最大可能交付|可靠交付
传输单位|面向报文|面向字节流
数据顺序|不保证|保证
数据正确性|不保证|保证
传输控制|无|拥塞控制<br/>流量控制
通信方式|一对一<br/>一对多<br/>多对一<br/>多对多|一对一
速度|快|慢

#### UDP

#### TCP
**三次握手**  
![](/assets/images/2019/三次握手.png)

三次握手的原因
> 第三次握手是为了防止失效的连接请求到达服务器，让服务器错误打开连接。
> 客户端发送的连接请求如果在网络中滞留，那么就会隔很长一段时间才能收到服务器端发回的连接确认。客户端等待一个超时重传时间之后，就会重新请求连接。但是这个滞留的连接请求最后还是会到达服务器，如果不进行三次握手，那么服务器就会打开两个连接。如果有第三次握手，客户端会忽略服务器之后发送的对滞留连接请求的连接确认，不进行第三次握手，因此就不会再次打开连接。

**四次挥手**  
![](/assets/images/2019/四次挥手.jpg)

四次挥手的原因
> 确保最后一个确认报文能够到达。如果 B 没收到 A 发送来的确认报文，那么就会重新发送连接释放请求报文，A 等待一段时间就是为了处理这种情况的发生。
> 等待一段时间是为了让本连接持续时间内所产生的所有报文都从网络中消失，使得下一个新的连接不会出现旧的连接请求报文。


### 应用层

协议名称|应用层协议|端口号|传输层协议|备注
:-:|:-:|:-:|:-:|:-
域名解析系统|DNS|53|UDP/TCP|长度超过 512 字节时使用 TCP
动态主机配置协议|DHCP|67/68|UDP|
简单网络管理协议|SNMP|161/162|UDP|
文件传送协议|FTP|20/21|TCP|控制连接 21，数据连接 20
远程终端协议|TELNET|23|TCP|
超文本传送协议|HTTP|80|TCP|
简单邮件传送协议|SMTP|25|TCP|
邮件读取协议|POP3|110|TCP|
网际报文存取协议|IMAP|143|TCP|

Web 页面请求过程
1. DHCP 配置主机信息
2. ARP 解析 MAC 地址
3. DNS 解析域名
4. HTTP 请求页面

#### HTTP
- URI - Uniform Resource Identifier
  - URL - Uniform Resource Locator
  - URN - Uniform Resource Name

HTTP 方法：客户端发送的请求报文第一行为请求行，包含了方法字段。
- GET 获取资源
- HEAD 获取报文首部
- POST 传输实体主体
- PUT 上传文件
- PATCH 对资源进行部分修改
- DELETE 删除文件
- OPTIONS 查询支持的方法
- CONNECT 要求在与代理服务器通信时建立隧道
- TRACE 追踪路径
