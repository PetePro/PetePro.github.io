---
layout: post
title:  "【OS】操作系统"
crawlertitle: "操作系统"
summary: "Operating System"
date:   2019-09-01 10:00:00 +0800
categories: posts
tags: 'CSSE'
author: xusc
bg: "SE.jpg"
---

操作系统

操作系统基本特征：
1. **并发**
   - 并发是指宏观上在一段时间内能同时运行多个程序；
   - 并行则指同一时刻能运行多个指令。
2. **共享**：系统中的资源可以被多个并发进程共同使用。
   - 互斥共享，互斥共享的资源称为临界资源
   - 同时共享
3. **虚拟**：虚拟技术把一个物理实体转换为多个逻辑实体。
   - 时分复用
   - 空分复用
4. **异步**：异步指进程不是一次性执行完毕，而是走走停停，以不可知的速度向前推进。

### 进程管理

#### 进程的特征
- 动态性：进程的实质是程序在多道程序系统中的一次执行过程，进程是动态产生，动态消亡的。
- 并发性：任何进程都可以同其他进程一起并发执行
- 独立性：进程是一个能独立运行的基本单位，同时也是系统分配资源和调度的独立单位；
- 异步性：由于进程间的相互制约，使进程具有执行的间断性，即进程按各自独立的、不可预知的速度向前推进
- 结构性：进程由程序、数据和进程控制块（PCB）三部分组成。

#### 进程与线程

区别|进程|线程
:-:|:-:|:-:
**基本单位**|资源分配的基本单位|独立调度的基本单位
**地址空间**|拥有独立地址空间|共享进程地址空间
**通信**|直接读写进程数据|IPC

#### 进程状态转换

![](/assets/images/2020/ProcessState.png)

#### 进程调度算法
- 批处理系统
  - 先来先服务 first-come first-serverd（FCFS）
  - 短作业优先 shortest job first（SJF）
  - 最短剩余时间优先 shortest remaining time next（SRTN）
- 交互式系统
  - 时间片轮转
  - 优先级调度
  - 多级反馈队列

#### 进程同步
- 临界区：对临界资源进行访问的那段代码
- 同步：多个进程因为合作产生的直接制约关系，使得进程有一定的先后执行关系。
- 互斥：多个进程在同一时刻只有一个进程能进入临界区。
- 信号量（Semaphore）：是一个整型变量，可以对其执行常见的 PV 操作。
- 管程：把控制的代码独立出来，不仅不容易出错，也使得客户端代码调用更容易。

经典同步问题：

#### 进程通信
- 进程同步：控制多个进程按一定顺序执行；
- 进程通信：进程间传输信息。

方法：
1. 管道；
2. FIFO 命名管道；
3. 消息队列；
4. 信号量；
5. 共享存储；
6. 套接字。

#### 死锁
产生死锁的必要条件：
- 互斥：每个资源要么已经分配给了一个进程，要么就是可用的。
- 占有和等待：已经得到了某个资源的进程可以再请求新的资源。
- 不可抢占：已经分配给一个进程的资源不能强制性地被抢占，它只能被占有它的进程显式地释放。
- 环路等待：有两个或者两个以上的进程组成一条环路，该环路中的每个进程都在等待下一个进程所占有的资源。

处理方法：
1. 死锁检测与死锁恢复：不试图阻止死锁，而是当检测到死锁发生时，采取措施进行恢复。
   - 死锁恢复：抢占、回滚、杀死进程
2. 死锁预防：破坏四个必要条件。
3. 死锁避免：银行家算法。



### 内存管理
- 虚拟内存的目的是为了让物理内存扩充成更大的逻辑内存，从而让程序获得更多的可用内存。
- 内存管理单元（MMU）管理着地址空间和物理内存的转换，其中的页表（Page table）存储着页（程序地址空间）和页框（物理内存空间）的映射表。
- 一个虚拟地址分成两个部分，一部分存储页面号，一部分存储偏移量。

#### 页面置换算法
页面置换算法的主要目标是使页面置换频率最低（也可以说缺页率最低）。
1. 最佳（OPT, Optimal replacement algorithm）：所选择的被换出的页面将是最长时间内不再被访问，是一种理论上的算法。
2. 最近最久未使用（LRU, Least Recently Used）
3. 最近未使用（NRU, Not Recently Used）
4. 先进先出（FIFO, First In First Out）
5. 时钟（Clock）

#### 分页与分段

区别|分页|分段
:-:|:-:|:-:
**大小是否固定**|大小固定|大小可变
**地址空间维度**|一维|二维
**存储位置**|物理地址空间|线性地址空间
**目的**|实现虚拟内存|使得逻辑上独立

- 段页式：程序的地址空间划分成多个拥有独立地址空间的段，每个段上的地址空间划分成大小相同的页。这样既拥有分段系统的共享和保护，又拥有分页系统的虚拟内存功能。



### 文件管理



### 设备管理

#### 磁盘结构
- 盘面（Platter）：一个磁盘有多个盘面；
- 磁道（Track）：盘面上的圆形带状区域，一个盘面可以有多个磁道；
- 扇区（Track Sector）：磁道上的一个弧段，一个磁道可以有多个扇区，它是最小的物理储存单位，目前主要有 512 bytes 与 4 K 两种大小；
- 磁头（Head）：与盘面非常接近，能够将盘面上的磁场转换为电信号（读），或者将电信号转换为盘面的磁场（写）；
- 制动手臂（Actuator arm）：用于在磁道之间移动磁头；
- 主轴（Spindle）：使整个盘面转动。

#### 磁盘调度算法
1. 先来先服务（FCFS, First Come First Served）
2. 最短寻道时间优先（SSTF, Shortest Seek Time First）
3. 电梯算法（SCAN）