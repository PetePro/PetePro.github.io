---
layout: post
title:  "【OS】Linux"
crawlertitle: "Linux"
summary: "Linux"
date:   2019-09-01 10:00:00 +0800
categories: posts
tags: 'CSSE'
author: xusc
---

Linux是一个免费的多用户、多任务的操作系统，Linux系统最大的特色是源代码完全公开，在符合GNU/GPL（通用公共许可证）的原则下，任何人都可以自由取得、散布甚至修改源代码。

### Linux基础
Linux系统应用领域
1. Linux服务器
2. 嵌入式Linux系统
3. 软件开发平台
4. 桌面应用

Linux系统的特点
1. 开放性
2. 多用户
3. 多任务
4. 良好的用户界面
5. 设备独立性
6. 丰富的网络功能
7. 可靠的系统安全
8. 良好的可移植性

Linux系统的**组成**
1. 内核
2. Shell
3. 文件系统
4. 应用程序

#### Linux发行版本

包管理工具|商业发行版|社区发行版
:-:|:-:|:-:
RPM<br/>(Redhat Package Manager)|Red Hat|Fedora/CentOS
DPKG|Ubuntu|Debian

主流Linux发行版本：（1）Red Hat（2）SUSE（3）Oracle（4）CentOS（5）Ubuntu（6）Debian（7）Mandriva（8）Gentoo（9）Slackware（10）Fedora

RHEL 7（Red Hat Enterprise Linux 7）是Red Hat公司开发的最新版本操作系统。Red Hat Linux系统优点：
1. 支持和硬件平台多
2. 优秀的安装界面
3. 独特的RPM升级方式
4. 丰富的软件包
5. 安全性能好
6. 方便的系统管理界面
7. 详细而完整的在线文档

#### Linux安装
合理的分区规划
- *swap 分区*：即交换分区，实现虚拟内存，建议大小是物理内存的1～2倍；
- */boot 分区*：用来存放与Linux系统启动有关的程序，比如引导装载程序等，最少200MB；
- /usr 分区：用来存放Linux系统中的应用程序，其相关数据较多，建议大小最少为8GB；
- /var 分区：用来存放Linux系统中经常变化的数据以及日志文件，建议大小最少为1GB；
- */ 分区*：Linux系统的根目录，所有的目录都挂在这个目录下面，建议大小最少为1GB；
- /home 分区：存放普通用户的数据，是普通用户的宿主目录，建议大小为剩下的空间。

在RHEL 7系统中默认使用FirewallD防火墙，FirewallD提供了支持网络/防火墙区域定义网络链接以及接口安全等级的动态防火墙管理工具。
- 支持IPv4、IPv6防火墙设置以及以太网桥接，并且拥有运行时配置和永久配置选项；
- 支持允许服务或者应用程序直接添加防火墙规则的接口；
- 支持动态配置，不用重启服务。

#### 字符界面
Linux字符界包括字符界面、图形界面下的终端以及虚拟控制台。

Bash基本操作
- 开关机
  - 关机：shutdown –h / halt
  - 重启：shutdown -r / reboot
- 求助：--help / man / info / doc
- 系统信息显示
  - uname：显示计算机及操作系统相关信息
  - hostname：显示或修改计算机主机名
  - free：查看内存信息
  - du：显示目录或文件的磁盘占用量
- 日期和时间
  - cal：显示日历信息
  - date：显示和设置系统日期和时间
  - hwclock：查看和设置硬件时钟
  - uptime：显示系统已经运行的时间
- 信息交流
  - echo：在显示器上显示文字
  - mesg：允许或拒绝写消息
  - wall：对全部已登录用户发送信息
  - write：向用户发送消息

RHEL 7使用目标（target）替换运行级别。目标使用目标单元文件描述，目标单位文件扩展名是.target，目标单元文件的唯一目标是将其他systemd单元文件通过一连串的依赖关系组织在一起。

**重定向**指的是使用文件代替标准输入、标准输出和标准错误输出。重定向有四种方式：输出重定向`>`、输入重定向`<`、错误重定向`2>`以及同时实现输出和错误的重定向`&>`。另外还有双向输出重定向`tee`。

**管道**`|`是将一个命令的标准输出作为另一个命令的标准输入，在数据需要经过多个步骤的处理之后才能得到我们想要的内容时就可以使用管道。

#### vi编辑器
vi编辑器工作模式
![](../assets/images/2019/vi.png)

#### 文件

文件类型
- 普通文件
- 目录文件
- 设备文件
  - 字符设备文件：最常见的字符设备文件是打印机和终端，可以接收字符流。
  - 块设备文件：块设备的主要特点是可以随机读写，而最常见的块设备就是磁盘。
- 管道文件（FIFO文件）
- 链接文件
  - 软链接（符号链接）文件：软链接文件又叫符号链接文件，这个文件包含了另一个文件的路径名。在对软链接文件进行读写的时候，系统会自动地把该操作转换为对源文件的操作，但删除软链接文件时，系统仅仅删除软链接文件，而不删除源文件本身。
  - 硬链接（实体链接）是已存在文件的另一个文件，对硬链接文件进行读写和删除操作时，结果和软链接相同。但如果删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了原有的内容。

目录结构
![](../assets/images/2019/Linux目录结构.png)

ls命令 `drwxr-xr-x 3 root root 17 May 6 00:14 .config`

列数|描述
:-:|:-
1|第1个字符表示文件的类型<br/>第2~4个字符表示文件的用户所有者对此文件的访问权限<br/>第5~7个字符表示文件的组群所有者对此文件的访问权限<br/>第8~10个字符表示其他用户对此文件的访问权限
2|文件的链接数
3|文件的用户所有者
4|文件的组群所有者
5|文件长度（也就是文件大小，不是文件的磁盘占用量）
6~8|文件的更改时间（mtime）/文件的最后访问时间（atime）
9|文件名称

基本操作
- 文件与目录基本操作
  - ls：列出文件或者目录的信息
  - cd：更改目录
  - mkdir：创建目录
  - rmdir：删除目录，目录必须为空
  - touch：更新文件时间或者建立新文件
  - cp：复制文件
  - rm：删除文件
  - mv：移动文件/重命名
  - find：列出文件系统内符合条件的文件
  - locate：在数据库中查找文件
  - which：指令搜索
  - whereis：文件搜索
  - split：将一个文件划分成多个文件
- 权限操作
  - chmod：修改权限
    - 文字设定法
    - 数字设定法
    - 文件默认权限：666，即 -rw-rw-rw-
    - 目录默认权限：777，即 drwxrwxrwx
    - 特殊权限：SUID、SGID、Sticky
  - chown：更改所有者
- 文件内容操作
  - cat：取得文件内容
  - tac：是 cat 的反向操作，从最后一行开始打印
  - more：分页显示文本文件
  - less：回卷显示文本文件
  - head：显示指定文件前若干行
  - tail：查看文件末尾数据
  - sort：对文件中的数据进行排序
  - uniq：将重复行从输出文件中删除
  - cut：从文件每行中显示出选定的字节、字符或字段
  - comm：逐行比较两个已排过序的文件
  - diff：逐行比较两个文本文件，列出其不同之处
  - grep：查找文件中符合条件的字符串
  - 字符转换
    - tr：删除一行中的字符，或者对字符进行替换
    - col：将 tab 字符转为空格字符
    - expand：将 tab 转换一定数量的空格，默认是 8 个
    - join：将有相同数据的那一行合并在一起
    - paste：直接将两行粘贴在一起

#### Shell编程
- Shell程序必须以`#!/bin/bash`开头。
- 常用Shell环境变量
  - HOME：用户主目录的完全路径名
  - PATH：系统环境变量
  - TERM：终端类型
  - UID：当前用户的UID
  - PWD：当前工作目录的绝对路径名
  - PS1：主提示符，在root用户下，默认的主提示符是“#”，在普通用户下，默认的主提示符是“$”
  - PS2：辅助提示符，默认的辅助提示符是“>”
- 位置参数是一种在调用Shell程序的命令行中按照各自的位置决定的变量，是在程序名之后输入的参数。
- 字符串比较：`=`是否相等，`!=`是否不同，`-n`长度是否大于0，`-z`长度是否等于0；
- 逻辑测试：`!`非，`-a`与，`-o`或；
- 文件测试：`-d`对象存在且为目录，`-f`对象存在且为文件。

#### 账户
- 用户账户分类
  - root用户：UID为0
  - 系统用户：又称虚拟用户、伪用户或假用户，UID为1~999
  - 普通用户：UID为1000~60000
- 与用户账户有关的配置文件
  - /etc/passwd
    - `zhangsan:x:1000:1000:张三:/home/zhangsan:/bin/bash`
    - 用户名:密码:用户标识号:组群标识号:用户名全称:主目录:Shell类型
  - /etc/shadow
    - `zhangsan:$6$E/xvWMmh$rhYLQwwffEqIudVLFzMlvkb0iN4.0Oluk6H.UovEYN0/99dVoHXcaCNGZZkFY1S3QHYgm7e6JPzEew6ybmN4e0:16364:0:99999:7:::`
    - 用户名:加密密码:用户最后一次更改密码的日期:密码允许更换前的天数:密码需要更换的天数:密码更换前警告的天数:账户被取消激活前的天数:用户账户过期日期:保留字段

- 组群账户分类
  - 私有组群和标准组群
  - 主要组群和次要组群
- 与组群账户有关的配置文件
  - /etc/group
    - `zhangsan:x:1000:`
    - 组群名:组群密码:组群标识号:组群成员
  - /etc/gshadow
    - `beijing:$6$E/xvWMmh$rhYLQwwffEqIudVLFzMlv1::ou`
    - 组群名:组群加密密码:组群管理者:组群成员

账户操作
- 用户账户：useradd，usermod，userdel；
- 组群账户：：groupadd，groupmod和groupdel；
- passwd：设置或修改用户的密码；
- gpasswd：设置一个组群的组群密码，或者是在组群中添加、删除用户；
- su：切换用户账户进行登录。如果su命令不加任何选项，默认为切换到root用户；
- newgrp：让用户账户以另一个组群的身份进行登录；
- groups：显示指定用户账户的组群成员身份；
- id：显示用户的UID以及该用户所属组群的GID。


